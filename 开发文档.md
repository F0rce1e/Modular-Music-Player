# Modular Music Player - 项目文档

## 项目概述

**Modular Music Player** 是一款专注于本地音频库播放的音乐播放器，提供极简的界面和高度自定义的功能。用户可以通过自由拖拽、调整布局和定制模块样式来构建个性化的音乐播放体验。本项目的核心目标是提供流畅、轻量的播放体验，同时保持简单、优雅的界面设计，确保内存占用尽可能低，避免成为用户的负担。

## 核心理念

**“简约、高效，尽在掌控”**

Modular Music Player 旨在为用户提供一个轻量级、低内存占用的音乐播放器。通过专注于本地音频库管理与播放，玩家可以根据自己的需求自由定制播放器的功能模块和外观布局。无论是一个简单的播放控制，还是丰富的自定义界面，用户都能轻松掌控。

## 核心特性

* **专注本地音频播放** ：播放器仅处理本地存储的音频文件，支持主流音频格式（如MP3、WAV、FLAC等）。
* **简约美观UI** ：基础UI设计简洁直观，去除不必要的复杂元素，注重易用性与美观性。
* **低内存占用** ：播放器在设计上以性能为优先，内存占用尽可能低，确保长时间使用时不会拖慢系统速度。
* **模块化设计** ：所有功能模块（如播放控制、音乐库、播放列表等）都是独立的组件，用户可以自由启用或禁用。
* **深度视觉定制** ：每个模块都支持颜色、透明度、字体等样式的个性化定制，背景支持图片或渐变。
* **开源共享** ：支持社区共享自定义布局、功能模块及插件，用户可以创建和分享自己的播放体验。

## 技术愿景

### 技术栈

* **核心框架** ：Electron + React + TypeScript
* **Electron** ：用于开发跨平台桌面应用，确保可以在Windows、macOS和Linux上运行。
* **React** ：构建动态和交互式UI，保证模块化的设计和高效的渲染。
* **TypeScript** ：增强开发效率，提供类型安全，减少运行时错误。
* **UI/UX** ：CSS-in-JS（如 `styled-components`），Flexbox布局，极简设计。
* **音频播放** ：`Howler.js` 或 `Web Audio API` 用于音频播放和音效处理。
* **模块化架构** ：组件化设计，每个功能模块独立，便于扩展和管理。
* **内存优化** ：高效的内存管理，避免冗余的内存占用。

### 性能优化

* **虚拟化与懒加载** ：对多模块界面使用虚拟化技术，如 `react-window`或 `react-virtualized`，避免一次性加载大量组件，减少内存占用。
* **主进程与渲染进程分离** ：音频播放和文件操作任务移至主进程，渲染进程专注于UI，避免UI线程阻塞。
* **内存管理** ：精简资源的使用，确保没有不必要的内存泄漏，持续优化内存占用。

### 开发工具

* **代码管理** ：Git + GitHub
* **构建工具** ：Webpack, Babel
* **包管理** ：npm / yarn
* **测试工具** ：Jest, React Testing Library

## 项目结构

以下是更新后的项目结构建议：

<pre class="overflow-visible! px-0!" data-start="1482" data-end="1982"><div class="contain-inline-size rounded-2xl corner-superellipse/1.1 relative bg-token-sidebar-surface-primary"><div class="sticky top-[calc(--spacing(9)+var(--header-height))] @w-xl/main:top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre!"><span><span>modular-music-player/
├── </span><span>public</span><span>/                  </span><span># 存放静态资源（如index.html、图标等）</span><span>
├── src/                  
│   ├── assets/              </span><span># 存放音频文件、背景图等</span><span>
│   ├── components/          </span><span># 组件（如播放控制、音乐库、歌词显示等）</span><span>
│   ├── modules/             </span><span># 功能模块（如播放控制、音乐库等）</span><span>
│   ├── services/            </span><span># 提供音频播放、文件操作等服务</span><span>
│   ├── styles/              </span><span># 样式（CSS-in-JS）</span><span>
│   ├── utils/               </span><span># 工具函数</span><span>
│   └── App.tsx              </span><span># 主应用组件</span><span>
├── package.json             </span><span># 项目配置文件</span><span>
└── webpack.config.js        </span><span># Webpack配置文件</span><span>
</span></span></code></div></div></pre>

## 功能设计

### 1. **本地音频播放**

* **音频库管理** ：用户可以导入本地音乐文件，播放器支持对文件的扫描、索引和播放。音频文件支持主流格式（如MP3、WAV、FLAC等）。
* **播放控制** ：提供基础的播放、暂停、快进、快退、音量调节等功能，UI简洁直观。

### 2. **简约UI设计**

* **基础UI** ：设计尽量简洁，提供必要的功能按钮，不做过多装饰。使用简洁的按钮图标和清晰的布局，避免冗余元素。
* **响应式布局** ：UI布局支持自动适配不同屏幕尺寸和分辨率，确保在各种环境下都能流畅运行。

### 3. **模块化设计**

每个组件都是独立的模块，用户可以选择启用或禁用不同的模块，例如：

* **播放控制模块** ：包括播放、暂停、跳转、音量调节等基本功能。
* **音乐库模块** ：显示本地音频文件，支持简单的排序、搜索和分类。
* **播放列表模块** ：用户可以管理和编辑播放列表。
* **歌词显示模块** ：同步显示歌词，提升听歌体验。

### 4. **视觉定制**

* **模块样式** ：每个模块都支持自定义样式，用户可以调整颜色、字体、透明度等，背景可以选择图片或渐变色。
* **界面主题** ：支持基本的主题切换，例如深色模式与浅色模式，提供简洁优雅的外观。

### 5. **内存优化**

* **懒加载** ：只加载当前可见的模块和音频文件，避免一次性加载过多资源，减小内存占用。
* **资源释放** ：播放器不使用的资源会及时释放，避免内存泄漏。
* **精简功能** ：去除不必要的功能模块，保持播放器轻量化。

### 6. **开源与社区共享**

* **布局保存与共享** ：用户可以保存和导出自己的布局与模块设置，方便在不同设备间同步或分享给他人。
* **插件系统** ：未来可以通过插件支持第三方开发的新功能，如自定义音效、播放模式等。

## 开发架构建议

### 1. **组件化设计**

采用React的组件化开发方式，每个功能模块（如播放控制、音乐库、歌词显示等）都是独立的组件，保证功能分离，易于维护和扩展。模块之间通过 `props`传递数据和事件，状态管理使用React Context。

### 2. **内存优化**

* **减少不必要的DOM渲染** ：通过 `React.memo`和 `useMemo`减少不必要的组件重新渲染。
* **虚拟化和懒加载** ：使用 `react-window`或 `react-virtualized`来优化组件渲染，只渲染当前视窗内的元素，减少内存占用。

### 3. **分离主进程与渲染进程**

使用Electron的主进程与渲染进程分离架构，将音频播放和文件操作任务移至主进程，渲染进程仅负责UI渲染，减少主进程对UI线程的影响，提高整体性能。

### 4. **性能监控与优化**

在开发过程中，使用 `React DevTools`和 `Electron DevTools`进行性能分析，识别潜在的性能瓶颈并优化。

## 开发顺序建议

### 1. **阶段一：基础架构与核心功能**

* 搭建React和Electron的基本架构
* 实现音频播放功能（支持MP3、WAV等格式）
* 开发基本的播放控制模块（播放、暂停、音量控制等）
* 实现简洁的音乐库模块，支持导入和显示本地音频文件

### 2. **阶段二：简约UI设计与模块化功能**

* 设计并实现简洁美观的UI，确保界面尽量简单
* 开发其他功能模块（如播放列表、歌词显示）
* 优化UI组件，确保内存占用低并支持快速响应

### 3. **阶段三：内存优化与性能测试**

* 优化内存管理，确保播放器在长时间使用时内存占用较低
* 使用懒加载和虚拟化技术，减少不必要的渲染
* 测试不同平台上的性能表现，进行必要的优化

### 4. **阶段四：开源与社区支持**

* 实现布局保存/导出功能，支持用户共享布局和模块
* 提供插件系统支持，未来可扩展更多功能
* 撰写文档，鼓励用户贡献和分享他们的模块与主题
